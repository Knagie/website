<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visual Timeline Planner</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.2s;
        }
        input[type="date"]::-webkit-calendar-picker-indicator:hover {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        
        // Internal Icon component using Inline SVGs for maximum reliability on hosted pages
        const Icon = ({ name, size = 20, className = "" }) => {
            const icons = {
                "layers": (
                    <g fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                        <polygon points="12 2 2 7 12 12 22 7 12 2" />
                        <polyline points="2 17 12 22 22 17" />
                        <polyline points="2 12 12 17 22 12" />
                    </g>
                ),
                "chevron-left": (
                    <path fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" d="m15 18-6-6 6-6" />
                ),
                "chevron-right": (
                    <path fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" d="m9 18 6-6-6-6" />
                ),
                "calendar-days": (
                    <g fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                        <rect width="18" height="18" x="3" y="4" rx="2" ry="2" />
                        <line x1="16" x2="16" y1="2" y2="6" />
                        <line x1="8" x2="8" y1="2" y2="6" />
                        <line x1="3" x2="21" y1="10" y2="10" />
                        <path d="M8 14h.01" />
                        <path d="M12 14h.01" />
                        <path d="M16 14h.01" />
                        <path d="M8 18h.01" />
                        <path d="M12 18h.01" />
                        <path d="M16 18h.01" />
                    </g>
                ),
                "plus": (
                    <path fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" d="M12 5v14M5 12h14" />
                ),
                "x": (
                    <path fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" d="M18 6 6 18M6 6l12 12" />
                ),
                "info": (
                    <g fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M12 16v-4" />
                        <path d="M12 8h.01" />
                    </g>
                )
            };

            return (
                <svg width={size} height={size} viewBox="0 0 24 24" className={className}>
                    {icons[name] || null}
                </svg>
            );
        };

        const COLOR_PALETTE = [
            { bg: 'bg-indigo-500', border: 'border-indigo-200', text: 'text-indigo-600', ring: 'ring-indigo-500' },
            { bg: 'bg-emerald-500', border: 'border-emerald-200', text: 'text-emerald-600', ring: 'ring-emerald-500' },
            { bg: 'bg-amber-500', border: 'border-amber-200', text: 'text-amber-600', ring: 'ring-amber-500' },
            { bg: 'bg-rose-500', border: 'border-rose-200', text: 'text-rose-600', ring: 'ring-rose-500' },
            { bg: 'bg-cyan-500', border: 'border-cyan-200', text: 'text-cyan-600', ring: 'ring-cyan-500' },
            { bg: 'bg-fuchsia-500', border: 'border-fuchsia-200', text: 'text-fuchsia-600', ring: 'ring-fuchsia-500' },
            { bg: 'bg-orange-500', border: 'border-orange-200', text: 'text-orange-600', ring: 'ring-orange-500' },
        ];

        const App = () => {
            const [currentYear, setCurrentYear] = useState(2026);
            const [activeTimelineId, setActiveTimelineId] = useState(1);
            const [dateMap, setDateMap] = useState(new Map());

            const [timelines, setTimelines] = useState([
                { id: 1, name: 'Project Alpha', startDate: '2026-07-05', endDate: '2026-08-22', ...COLOR_PALETTE[0] },
                { id: 2, name: 'Summer Break', startDate: '2026-07-04', endDate: '2026-08-16', ...COLOR_PALETTE[1] },
                { id: 3, name: 'Workshop', startDate: '2026-07-11', endDate: '2026-08-23', ...COLOR_PALETTE[2] },
            ]);

            const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            const daysOfWeek = ["M", "T", "W", "T", "F", "S", "S"];

            // Initial sync
            useEffect(() => {
                syncAllDates(timelines);
            }, []);

            const getDaysInMonth = (year, month) => new Date(year, month + 1, 0).getDate();
            const getFirstDayOfMonth = (year, month) => {
                const day = new Date(year, month, 1).getDay();
                return day === 0 ? 6 : day - 1;
            };

            const formatDate = (year, month, day) => `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

            const applyRangeToMap = (map, startStr, endStr, timelineId) => {
                if (!startStr || !endStr) return;
                const start = new Date(startStr);
                const end = new Date(endStr);
                if (isNaN(start.getTime()) || isNaN(end.getTime())) return;
                let current = new Date(start);
                while (current <= end) {
                    const dateStr = current.toISOString().split('T')[0];
                    const existing = map.get(dateStr) || new Set();
                    existing.add(timelineId);
                    map.set(dateStr, existing);
                    current.setDate(current.getDate() + 1);
                }
            };

            const syncAllDates = (updatedTimelines) => {
                const newMap = new Map();
                updatedTimelines.forEach(t => applyRangeToMap(newMap, t.startDate, t.endDate, t.id));
                setDateMap(newMap);
            };

            const updateTimeline = (id, field, value) => {
                const nextTimelines = timelines.map(t => t.id === id ? { ...t, [field]: value } : t);
                setTimelines(nextTimelines);
                if (field === 'startDate' || field === 'endDate') syncAllDates(nextTimelines);
            };

            const addNewTimeline = () => {
                const nextId = Math.max(0, ...timelines.map(t => t.id)) + 1;
                const color = COLOR_PALETTE[nextId % COLOR_PALETTE.length];
                const newT = { id: nextId, name: `Timeline ${nextId}`, startDate: '', endDate: '', ...color };
                setTimelines([...timelines, newT]);
                setActiveTimelineId(nextId);
            };

            const removeTimeline = (id) => {
                if (timelines.length === 1) return;
                const nextTimelines = timelines.filter(t => t.id !== id);
                setTimelines(nextTimelines);
                if (activeTimelineId === id) setActiveTimelineId(nextTimelines[0].id);
                syncAllDates(nextTimelines);
            };

            const toggleDateManually = (dateStr, timelineId) => {
                const newMap = new Map(dateMap);
                const existing = newMap.get(dateStr) || new Set();
                existing.has(timelineId) ? existing.delete(timelineId) : existing.add(timelineId);
                existing.size === 0 ? newMap.delete(dateStr) : newMap.set(dateStr, existing);
                setDateMap(newMap);
            };

            const renderMonth = (monthIdx) => {
                const daysInMonth = getDaysInMonth(currentYear, monthIdx);
                const firstDay = getFirstDayOfMonth(currentYear, monthIdx);
                const days = [];
                for (let i = 0; i < firstDay; i++) days.push(<div key={`empty-${i}`} className="h-10 w-10 md:h-12 md:w-12" />);
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateStr = formatDate(currentYear, monthIdx, day);
                    const activeIds = dateMap.get(dateStr) || new Set();
                    const isToday = new Date().toISOString().split('T')[0] === dateStr;
                    days.push(
                        <div key={dateStr} className="relative h-10 w-10 md:h-12 md:w-12 flex flex-col items-center justify-center">
                            <button
                                onClick={() => toggleDateManually(dateStr, activeTimelineId)}
                                className={`h-8 w-8 text-xs rounded-lg flex items-center justify-center transition-all 
                                    ${isToday ? 'ring-2 ring-slate-400 font-bold' : ''}
                                    ${activeIds.size > 0 ? 'bg-slate-50 font-semibold text-slate-900' : 'hover:bg-slate-100 text-slate-400'}
                                `}
                            >
                                {day}
                            </button>
                            <div className="absolute bottom-1 flex gap-0.5 w-full px-1.5 justify-center">
                                {timelines.map(t => activeIds.has(t.id) && <div key={t.id} className={`h-1 flex-1 rounded-full ${t.bg}`} />)}
                            </div>
                            {activeIds.size > 1 && <div className="absolute top-1 right-1 bg-slate-800 text-white text-[7px] h-3 w-3 flex items-center justify-center rounded-full pointer-events-none">{activeIds.size}</div>}
                        </div>
                    );
                }
                return (
                    <div key={monthIdx} className="bg-white p-4 rounded-3xl shadow-sm border border-slate-200">
                        <h3 className="font-bold text-slate-800 mb-4 text-center">{months[monthIdx]}</h3>
                        <div className="grid grid-cols-7 gap-1">
                            {daysOfWeek.map((d, i) => <div key={i} className={`h-8 flex items-center justify-center text-[10px] font-bold uppercase ${i >= 5 ? 'text-rose-400' : 'text-slate-400'}`}>{d}</div>)}
                            {days}
                        </div>
                    </div>
                );
            };

            const activeTimeline = timelines.find(t => t.id === activeTimelineId);

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <header className="max-w-[1600px] mx-auto mb-8 flex flex-col md:flex-row md:items-center justify-between gap-6">
                        <div>
                            <div className="flex items-center gap-3 mb-2">
                                <div className="bg-indigo-600 p-2.5 rounded-2xl shadow-lg shadow-indigo-100">
                                    <Icon name="layers" className="text-white" />
                                </div>
                                <h1 className="text-2xl font-black tracking-tight text-slate-800">Visual Timeline Planner</h1>
                            </div>
                            <p className="text-slate-500 font-medium">European standard (ISO 8601) â€¢ Monday-start calendar</p>
                        </div>
                        <div className="flex items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-slate-200">
                            <button onClick={() => setCurrentYear(prev => prev - 1)} className="p-2 hover:bg-slate-100 rounded-xl transition-colors text-slate-400 hover:text-indigo-600">
                                <Icon name="chevron-left" size={24} />
                            </button>
                            <span className="text-2xl font-black px-4 tabular-nums text-slate-700">{currentYear}</span>
                            <button onClick={() => setCurrentYear(prev => prev + 1)} className="p-2 hover:bg-slate-100 rounded-xl transition-colors text-slate-400 hover:text-indigo-600">
                                <Icon name="chevron-right" size={24} />
                            </button>
                        </div>
                    </header>

                    <main className="max-w-[1600px] mx-auto grid grid-cols-1 xl:grid-cols-12 gap-8">
                        <div className="xl:col-span-4 space-y-6">
                            <div className="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-200">
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-xs font-black text-slate-400 uppercase tracking-widest flex items-center gap-2">
                                        <Icon name="calendar-days" size={14} /> My Timelines
                                    </h2>
                                    <button onClick={addNewTimeline} className="bg-indigo-50 text-indigo-600 p-2 rounded-xl hover:bg-indigo-100 transition-colors">
                                        <Icon name="plus" size={20} />
                                    </button>
                                </div>
                                <div className="space-y-4 max-h-[60vh] overflow-y-auto pr-2 custom-scrollbar">
                                    {timelines.map(t => (
                                        <div key={t.id} onClick={() => setActiveTimelineId(t.id)} className={`p-4 rounded-2xl border-2 transition-all cursor-pointer ${activeTimelineId === t.id ? `${t.border} bg-white shadow-md scale-[1.02]` : 'border-transparent bg-slate-50 opacity-70 hover:opacity-100'}`}>
                                            <div className="flex items-center justify-between mb-3">
                                                <input type="text" value={t.name} onChange={(e) => updateTimeline(t.id, 'name', e.target.value)} className={`bg-transparent font-bold text-sm outline-none w-full mr-2 ${t.text}`} onClick={(e) => e.stopPropagation()} />
                                                {timelines.length > 1 && <button onClick={(e) => { e.stopPropagation(); removeTimeline(t.id); }} className="text-slate-300 hover:text-rose-500 transition-colors"><Icon name="x" size={16} /></button>}
                                            </div>
                                            <div className="grid grid-cols-2 gap-3" onClick={(e) => e.stopPropagation()}>
                                                <div><label className="text-[10px] font-bold text-slate-400 uppercase ml-1">Start</label>
                                                <input type="date" value={t.startDate} onChange={(e) => updateTimeline(t.id, 'startDate', e.target.value)} className="w-full text-xs p-2 rounded-lg border border-slate-200 outline-none focus:ring-1 focus:ring-indigo-500" /></div>
                                                <div><label className="text-[10px] font-bold text-slate-400 uppercase ml-1">End</label>
                                                <input type="date" value={t.endDate} onChange={(e) => updateTimeline(t.id, 'endDate', e.target.value)} className="w-full text-xs p-2 rounded-lg border border-slate-200 outline-none focus:ring-1 focus:ring-indigo-500" /></div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                            <div className="bg-indigo-900 p-8 rounded-[2rem] text-white shadow-xl shadow-indigo-100">
                                <h3 className="font-black text-lg mb-2 flex items-center gap-2">
                                    <Icon name="info" className="text-indigo-400" size={20} />
                                    Quick Tip
                                </h3>
                                <p className="text-indigo-200 text-sm leading-relaxed">Select a timeline to make it "Active", then click days on the calendar to manually toggle them or adjust the ranges above!</p>
                            </div>
                        </div>
                        <div className="xl:col-span-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">{months.map((_, i) => renderMonth(i))}</div>
                    </main>
                    
                    <footer className="max-w-[1600px] mx-auto mt-12 py-8 border-t border-slate-200 flex flex-col md:flex-row justify-between items-center gap-6">
                        <div className="flex items-center gap-6 text-slate-400 text-xs font-bold uppercase tracking-widest">
                            <div className="flex items-center gap-2"><div className="w-2 h-2 rounded-full bg-rose-400" /> Weekends</div>
                            <div className="flex items-center gap-2"><div className="w-2 h-2 rounded-full bg-slate-900" /> Today</div>
                        </div>
                        <div className="flex flex-wrap justify-center gap-4">
                           {timelines.map(t => (
                             <div key={t.id} className="flex items-center gap-2 bg-white px-3 py-1.5 rounded-full border border-slate-100 shadow-sm">
                               <div className={`w-2.5 h-2.5 rounded-full ${t.bg}`} />
                               <span className="text-[10px] font-black uppercase text-slate-600">{t.name}</span>
                             </div>
                           ))}
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
